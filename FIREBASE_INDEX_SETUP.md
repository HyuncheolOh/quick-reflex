# Firebase Firestore 인덱스 설정

## 인덱스가 필요한 이유
Firestore에서 복합 쿼리(여러 필드를 동시에 사용하는 쿼리)를 실행하려면 인덱스가 필요합니다.

## 인덱스 생성 방법

### 방법 1: 에러 메시지의 링크 사용 (가장 쉬움)
1. 콘솔에 나타난 에러 메시지의 링크를 클릭:
   ```
   https://console.firebase.google.com/v1/r/project/quick-reflex-1e346/firestore/indexes?create_composite=...
   ```
2. Firebase Console로 자동 이동됨
3. **인덱스 만들기** 버튼 클릭
4. 5-10분 정도 기다리면 자동으로 인덱스 생성 완료

### 방법 2: Firebase Console에서 수동 생성
1. [Firebase Console](https://console.firebase.google.com) 접속
2. 프로젝트 선택 (quick-reflex-1e346)
3. 좌측 메뉴에서 **Firestore Database** 클릭
4. 상단 탭에서 **인덱스** 클릭
5. **인덱스 만들기** 버튼 클릭
6. 다음 정보 입력:

#### 인덱스 1: 리더보드 정렬용
- **컬렉션 ID**: `leaderboard`
- **필드**:
  - 필드 경로: `gameType` / 정렬: 오름차순
  - 필드 경로: `bestTime` / 정렬: 오름차순
- **쿼리 범위**: 컬렉션
- **만들기** 클릭

#### 인덱스 2: 순위 계산용 (선택사항)
- **컬렉션 ID**: `leaderboard`
- **필드**:
  - 필드 경로: `gameType` / 정렬: 오름차순
  - 필드 경로: `bestTime` / 정렬: 내림차순
- **쿼리 범위**: 컬렉션
- **만들기** 클릭

## 인덱스 생성 상태 확인
- Firebase Console > Firestore > 인덱스 탭
- 상태가 "빌드 중"에서 "사용 가능"으로 변경될 때까지 대기
- 보통 5-10분 소요

## 인덱스 생성 완료 후
1. 앱을 새로고침하거나 재시작
2. 리더보드 화면 다시 접속
3. 정상적으로 데이터가 로드되는지 확인

## 자주 발생하는 문제

### "인덱스가 아직 빌드 중입니다" 오류
- 인덱스 생성에는 시간이 걸립니다 (5-10분)
- Firebase Console에서 인덱스 상태 확인
- "사용 가능" 상태가 될 때까지 대기

### 인덱스 생성 후에도 오류 발생
- 브라우저 캐시 삭제 후 재시도
- 앱 완전히 재시작 (`npm run start`)
- Firebase Console에서 인덱스가 올바르게 생성되었는지 확인

## 추가 권장 인덱스 (성능 최적화)

### 사용자별 기록 조회용
- **컬렉션 ID**: `leaderboard`
- **필드**:
  - 필드 경로: `userId` / 정렬: 오름차순
  - 필드 경로: `timestamp` / 정렬: 내림차순
- **쿼리 범위**: 컬렉션

### 최근 기록 조회용
- **컬렉션 ID**: `leaderboard`
- **필드**:
  - 필드 경로: `timestamp` / 정렬: 내림차순
- **쿼리 범위**: 컬렉션

## 인덱스 관리 팁
- 인덱스는 무료 할당량이 있음 (200개)
- 사용하지 않는 인덱스는 삭제 가능
- 인덱스가 많을수록 쓰기 성능이 약간 저하될 수 있음
- 필요한 인덱스만 생성하는 것이 좋음